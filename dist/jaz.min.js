/*! Jaz v1.1.0
 // alpha version 1.0   
 // MIT Licensed http://opensource.org/licenses/MIT
 */

const Status={inProcess:!1},Scope=function(e){if("string"!=typeof e)throw new Error("Scope objects must be constructed with a string.");if(this._scope=void 0,"*"===e)return void(this._scope="a");const t=/(^(\.|#)[a-zA-Z](\w+)?)/g,o=/(data-[a-zA-Z](\w+)?)/g;if(e.match(t)){if(!document.querySelector("a"+e))throw new Error("Scope identifier was not found in the scope of the web page: "+e+"\nCheck to see you're attempting to reference the correct element.");this._scope="a"+e}else{if(!e.match(o))throw new Error("Scope string is invalid: "+e+"\nYou must define the scope with either a reference to a class, ID, or data-* attribute name.");if(!document.querySelector("a["+e+"]"))throw new Error("Scope identifier was not found in the scope of the web page: "+e+"\nCheck to see you're attempting to reference the correct element.");this._scope="a["+e+"]"}};Scope.prototype.identifier=function(){return this._scope};const Intermission=function(e){if("undefined"==typeof e||!e)return console.warn("Intermission object is undefined; assumed no Intermission is requested."),void(this.loading=null);if("object"!=typeof e)throw new Error("Intermission objects must be constructed with an basic object containing the loading function and a callback function.");const t=e.loading,o=e.callback;if("undefined"==typeof o||"undefined"==typeof t)throw new Error("Error when defining intermission and callback.");this.loading=t,this.callback=o};Intermission.prototype.fire=function(){"function"==typeof this.loading&&this.loading&&this.loading()},Intermission.prototype.done=function(){"function"==typeof this.callback&&this.callback&&this.callback()};const Target=function(e){if("string"!=typeof e)throw new Error("Target objects must be constructed with a string.");this._target=void 0;const t=/(^(\.|#)?[a-zA-Z](\w+)?)/g;if(!e.match(t))throw new Error("Target string is invalid: "+e+"\nYou must define the target with either a reference to a class, ID, or tag name.");if(!document.querySelector(e))throw new Error("Target identifier was not found in the scope of the web page: "+e+"\nCheck to see you're attempting to reference the correct element.");this._target=e};Target.prototype.identifier=function(){if("undefined"==typeof this._target||!this._target)throw new Error("Attempted to access an invalid target value from a Target object.\nMake sure the Target object was constructed correctly.");return this._target};const Jaz=function(){this.status=Status,this.scope=void 0,this.intermission=void 0,this.targetArea=void 0};Jaz.prototype.config=function(e){if("object"!=typeof e||!e)throw new Error("Configuration settings must be an object.");try{const t=e.scope,o=e.intermission,n=e.targetArea}catch(i){throw new Error("Configuration object must be constructed with a string, and an object of functions: "+i.message)}this.scope=new Scope(t),this.intermission=new Intermission(o),this.targetArea=new Target(n)},Jaz.prototype.remoteBlockRouting=function(){if("object"!=typeof this.scope||!this.scope)throw new Error("Error: undefined or invalid scope.");for(var e=[],t=0;t<document.querySelectorAll(this.scope.identifier()).length;t++)e.push(document.querySelectorAll(this.scope.identifier())[t]);e.map(function(e){var t=e.href;e.addEventListener("click",function(e){this.reconfigureRouting(e,t)}.bind(this))}.bind(this))},Jaz.prototype.reconfigureRouting=function(e,t){if(e.preventDefault(),!this.status.inProcess){this.status.inProcess=!0,this.intermission.fire();var o;console.log("Route path: "+t),window.XMLHttpRequest?(o=new XMLHttpRequest,console.log("Request created.")):(o=new ActiveXObject("Microsoft.XMLHTTP"),console.log("Request created.")),o.open("GET",t,!0),o.onreadystatechange=function(){if(o.readyState==XMLHttpRequest.DONE){if(200!=o.status)throw new Error("AJAX load failed: invalid status returned: "+o.status);console.log("Request success."),this.parseHTML(o.responseText),window.history.pushState({},"",t),this.intermission.done(),this.remoteBlockRouting(),this.status.inProcess=!1}}.bind(this),o.send()}},Jaz.prototype.listen=function(){console.warn("Jaz is listening..."),window.Jaz_Reference=this,this.remoteBlockRouting()},Jaz.prototype.parseHTML=function(e){const t=document.createElement("html");t.innerHTML=e;const o=t.querySelector(this.targetArea.identifier());document.querySelector(this.targetArea.identifier()).innerHTML=o.innerHTML},window.onpopstate=function(e){if("object"==typeof window.Jaz_Reference&&window.Jaz_Reference&&e.state){var t=window.location.href||document.URL;Jaz_Reference.reconfigureRouting(e,t)}},window.Jaz=Jaz;
